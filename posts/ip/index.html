<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
  <link href="https://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="generator" content="Hugo 0.70.0" />

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>TCP/IP &middot; 梦还在吗</title>
  <meta name="description" content="" />

  
  <link type="text/css" rel="stylesheet" href="http://example.org/css/print.css" media="print">
  <link type="text/css" rel="stylesheet" href="http://example.org/css/poole.css">
  <link type="text/css" rel="stylesheet" href="http://example.org/css/syntax.css">
  <link type="text/css" rel="stylesheet" href="http://example.org/css/hyde.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Abril+Fatface|PT+Sans:400,400i,700">


  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/favicon.png">

  
  
</head>

  <body class="theme-base-0d ">
  <aside class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <a href="http://example.org/"><h1>梦还在吗</h1></a>
      <p class="lead">
       随便记录悲惨世界 
      </p>
    </div>

    <nav>
      <ul class="sidebar-nav">
        <li><a href="http://example.org/">Home</a> </li>
        
      </ul>
    </nav>

    <p>&copy; 2020. All rights reserved. </p>
  </div>
</aside>

    <main class="content container">
    <div class="post">
  <h1>TCP/IP</h1>
  <time datetime=2020-04-13T13:37:30Z class="post-date">Mon, Apr 13, 2020</time>
  <h1 id="tcpip">TCP/IP</h1>
<h2 id="传输层">传输层</h2>
<h3 id="传输层概述">传输层概述</h3>
<ul>
<li>传输层提供端到端的连接</li>
<li>网络层提供点到点的连接</li>
</ul>
<h3 id="传输层端口port">传输层端口:Port</h3>
<p><img src="https://kxpic.oss-cn-shenzhen.aliyuncs.com/Notable/By8B7w.png" alt="By8B7w">
<img src="https://kxpic.oss-cn-shenzhen.aliyuncs.com/Notable/gx4KZ5.png" alt="gx4KZ5">
<img src="https://kxpic.oss-cn-shenzhen.aliyuncs.com/Notable/TEmxmn.png" alt="TEmxmn">
<img src="https://kxpic.oss-cn-shenzhen.aliyuncs.com/Notable/ywtRAk.png" alt="ywtRAk"></p>
<h3 id="传输层协议">传输层协议</h3>
<h4 id="tcp">TCP</h4>
<ul>
<li>Transmission Control Protocol,传输控制协议</li>
<li>可靠的、面向连接的协议</li>
<li>传输效率低、类似打电话</li>
</ul>
<h4 id="udp">UDP</h4>
<ul>
<li>User Datagram Protocol,用户数据报协议</li>
<li>不可靠的、无连接的服务</li>
<li>传输效率高,类似群聊</li>
</ul>
<h3 id="tcp和udp数据包结构对比">TCP和UDP数据包结构对比</h3>
<p><img src="https://kxpic.oss-cn-shenzhen.aliyuncs.com/Notable/WuCfVM.png" alt="WuCfVM"></p>
<h3 id="tcp会话的建立三次握手">TCP会话的建立:三次握手</h3>
<p><img src="https://kxpic.oss-cn-shenzhen.aliyuncs.com/Notable/TmydGO.png" alt="TmydGO"></p>
<p>seq:序列号
SYN:同步位
ACK:确认位
win:窗口位
FIN:终止位</p>
<h3 id="tcp会话的确认和重传">TCP会话的确认和重传</h3>
<p><img src="https://kxpic.oss-cn-shenzhen.aliyuncs.com/Notable/6q3zao.png" alt="6q3zao">
通过序列号加字节来确认
<img src="https://kxpic.oss-cn-shenzhen.aliyuncs.com/Notable/tWc80x.png" alt="tWc80x">
<img src="https://kxpic.oss-cn-shenzhen.aliyuncs.com/Notable/GQzMdo.png" alt="GQzMdo"></p>
<h3 id="tcp会话的拥塞和流量控制">TCP会话的拥塞和流量控制</h3>
<p><img src="https://kxpic.oss-cn-shenzhen.aliyuncs.com/Notable/S418Qv.png" alt="S418Qv"></p>
<h3 id="tcp会话的终止四次挥手">TCP会话的终止:四次挥手</h3>
<p><img src="https://kxpic.oss-cn-shenzhen.aliyuncs.com/Notable/gTRMgD.png" alt="gTRMgD"></p>
<h3 id="udp传输过程">UDP传输过程</h3>
<p><img src="https://kxpic.oss-cn-shenzhen.aliyuncs.com/Notable/9DypuJ.png" alt="9DypuJ"></p>
<h3 id="tcp和udp的对比">TCP和UDP的对比</h3>
<table>
<thead>
<tr>
<th align="center">传输控制协议(TCP)</th>
<th align="center">用户数据报协议(UDP)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">面向连接</td>
<td align="center">无连接</td>
</tr>
<tr>
<td align="center">可靠传输</td>
<td align="center">尽力而为的传输</td>
</tr>
<tr>
<td align="center">支持流控及窗口控制机制</td>
<td align="center">无流控及窗口机制</td>
</tr>
<tr>
<td align="center">HTTP、TFP等</td>
<td align="center">TFTP、DNS、DHCP等</td>
</tr>
</tbody>
</table>
<h2 id="others">Others</h2>
<p><img src="http://cn.linux.vbird.org/linux_server/0110network_basic_files/osi_tcpip.gif" alt="osi_tcpip.gif"></p>
<p>那 TCP/IP 是如何运作的呢？我们就拿妳常常连上的 Yahoo 入口网站来做个说明好了，整个联机的状态可以这样看：
0 应用程序阶段：妳打开浏览器，在浏览器上面输入网址列，按下 [Enter]。此时网址列与相关数据会被浏览器包成一个数据， 并向下传给 TCP/IP 的应用层；</p>
<ol>
<li>应用层：由应用层提供的 HTTP 通讯协议，将来自浏览器的数据报起来，并给予一个应用层表头，再向传送层丢去；</li>
<li>传送层：由于 HTTP 为可靠联机，因此将该数据丢入 TCP 封包内，并给予一个 TCP 封包的表头，向网络层丢去；</li>
<li>网络层：将 TCP 包裹包进 IP 封包内，再给予一个 IP 表头 (主要就是来源与目标的 IP 啰)，向链结层丢去；</li>
<li>链结层：如果使用以太网络时，此时 IP 会依据 CSMA/CD 的标准，包裹到 MAC 讯框中，并给予 MAC 表头，再转成位串后， 利用传输媒体传送到远程主机上。</li>
</ol>
<p><a href="http://cn.linux.vbird.org/linux_server/0110network_basic.php#whatisnetwork_osi">鸟哥的 Linux 私房菜 &ndash; 基础网络概念</a></p>
<h3 id="三次握手与四次挥手">三次握手与四次挥手</h3>
<p><img src="https://kxpic.oss-cn-shenzhen.aliyuncs.com/uPic/xyLamj.jpg" alt="xyLamj"></p>
<ul>
<li>为了方便描述我们将主动发起请求的172.16.50.72:65076 主机称为客户端，将返回数据的主机172.16.17.94:8080称为服务器。</li>
<li>第一次握手: 建立连接。客户端发送连接请求，发送SYN报文，将seq设置为0。然后，客户端进入SYN_SEND状态，等待服务器的确认。</li>
<li>第二次握手: 服务器收到客户端的SYN报文段。需要对这个SYN报文段进行确认，发送ACK报文，将ack设置为1。同时，自己还要发送SYN请求信息，将seq为0。服务器端将上述所有信息一并发送给客户端，此时服务器进入SYN_RECV状态。</li>
<li>第三次握手: 客户端收到服务器的ACK和SYN报文后，进行确认，然后将ack设置为1，seq设置为1，向服务器发送ACK报文段，这个报文段发送完毕以后，客户端和服务器端都进入ESTABLISHED状态，完成TCP三次握手。</li>
</ul>
<p><img src="https://kxpic.oss-cn-shenzhen.aliyuncs.com/uPic/16h3EW.jpg" alt="16h3EW"></p>
<ul>
<li>第一次挥手：客户端向服务器发送一个FIN报文段，将设置seq为160和ack为112，;此时，客户端进入 FIN_WAIT_1状态,这表示客户端没有数据要发送服务器了，请求关闭连接;</li>
<li>第二次挥手：服务器收到了客户端发送的FIN报文段，向客户端回一个ACK报文段，ack设置为1，seq设置为112;服务器进入了CLOSE_WAIT状态，客户端收到服务器返回的ACK报文后，进入FIN_WAIT_2状态;</li>
<li>第三次挥手：服务器会观察自己是否还有数据没有发送给客户端，如果有，先把数据发送给客户端，再发送FIN报文；如果没有，那么服务器直接发送FIN报文给客户端。请求关闭连接，同时服务器进入LAST_ACK状态;</li>
<li>第四次挥手：客户端收到服务器发送的FIN报文段，向服务器发送ACK报文段，将seq设置为161，将ack设置为113，然后客户端进入TIME_WAIT状态;服务器收到客户端的ACK报文段以后，就关闭连接;此时，客户端等待2MSL后依然没有收到回复，则证明Server端已正常关闭，客户端也可以关闭连接了。</li>
</ul>
<h3 id="tcp与udp的区别">TCP与UDP的区别</h3>
<ol>
<li>TCP面向连接（如打电话要先拨号建立连接）;UDP是无连接的，即发送数据之前不需要建立连接</li>
<li>TCP提供可靠的服务。也就是说，通过TCP连接传送的数据，无差错，不丢失，不重复，且按序到达;UDP尽最大努力交付，即不保   证可靠交付</li>
<li>TCP面向字节流，实际上是TCP把数据看成一连串无结构的字节流;UDP是面向报文的</li>
<li>每一条TCP连接只能是点到点的;UDP支持一对一，一对多，多对一和多对多的交互通信</li>
<li>TCP首部开销20字节;UDP的首部开销小，只有8个字节</li>
<li>TCP的逻辑通信信道是全双工的可靠信道，UDP则是不可靠信道</li>
</ol>
<p>例，TCP连接就像是打电话，两者之间必须有一条不间断的通路，数据不到达对方，对方就一直在等待，除非对方直接挂断电话。先说的话先到，后说的后到，有顺序。</p>

</div>


    </main>

    
      
    
  </body>
</html>
