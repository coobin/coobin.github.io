<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
  <link href="https://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="generator" content="Hugo 0.70.0" />

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Router &middot; 梦还在吗</title>
  <meta name="description" content="" />

  
  <link type="text/css" rel="stylesheet" href="http://example.org/css/print.css" media="print">
  <link type="text/css" rel="stylesheet" href="http://example.org/css/poole.css">
  <link type="text/css" rel="stylesheet" href="http://example.org/css/syntax.css">
  <link type="text/css" rel="stylesheet" href="http://example.org/css/hyde.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Abril+Fatface|PT+Sans:400,400i,700">


  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/favicon.png">

  
  
</head>

  <body class="theme-base-0d ">
  <aside class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <a href="http://example.org/"><h1>梦还在吗</h1></a>
      <p class="lead">
       随便记录悲惨世界 
      </p>
    </div>

    <nav>
      <ul class="sidebar-nav">
        <li><a href="http://example.org/">Home</a> </li>
        
      </ul>
    </nav>

    <p>&copy; 2020. All rights reserved. </p>
  </div>
</aside>

    <main class="content container">
    <div class="post">
  <h1>Router</h1>
  <time datetime=2020-04-13T09:51:29Z class="post-date">Mon, Apr 13, 2020</time>
  <h1 id="router">Router</h1>
<h3 id="定义">定义</h3>
<p>路由是用于网络中不同网段之间的相互通信,路由信息就是指导报文发送的路径信息,路由的过程就是报文转发的过程.</p>
<h3 id="分类">分类</h3>
<ol>
<li>直连路由</li>
<li>静态路由</li>
<li>动态路由</li>
</ol>
<h3 id="术语">术语:</h3>
<p><img src="https://kxpic.oss-cn-shenzhen.aliyuncs.com/Notable/Anbfd9.png" alt="Anbfd9">
<img src="https://kxpic.oss-cn-shenzhen.aliyuncs.com/Notable/GDGN4b.png" alt="GDGN4b"></p>
<h3 id="过程">过程</h3>
<p><img src="https://kxpic.oss-cn-shenzhen.aliyuncs.com/Notable/0CiDwE.png" alt="0CiDwE"></p>
<p>当路由器(或其他三层设备)收到一个IP数据包时,会查看数据包的IP头部中的<!-- raw HTML omitted -->目的IP地址<!-- raw HTML omitted -->,并在路由表中进行查找,在匹配到<!-- raw HTML omitted -->最优的路由<!-- raw HTML omitted -->后,将该数据包扔给该路由所指的出接口或下一跳.</p>
<p><img src="https://kxpic.oss-cn-shenzhen.aliyuncs.com/Notable/4ztkgr.png" alt="4ztkgr"></p>
<h3 id="路由器转发数据包">路由器转发数据包</h3>
<p><img src="https://kxpic.oss-cn-shenzhen.aliyuncs.com/Notable/vcIC5U.png" alt="vcIC5U"></p>
<ul>
<li>路由器需要知道下一跳和出接口才能将数据转发出去.</li>
</ul>
<h3 id="路由表">路由表</h3>
<p><img src="https://kxpic.oss-cn-shenzhen.aliyuncs.com/Notable/4Ib8Wg.png" alt="4Ib8Wg"></p>
<h3 id="路由优先级">路由优先级</h3>
<p><img src="https://kxpic.oss-cn-shenzhen.aliyuncs.com/Notable/8VBwiK.png" alt="8VBwiK"></p>
<h3 id="等价路由-ecmpequal-cost-multi-path">等价路由: ECMP,Equal Cost Multi-Path</h3>
<p>对于相同路由来源,相同目标网络,存在多条相同度量值的路由时,这些路由都会被加入到路由表中,数据包会在这几个链路上进行负载分担.
<img src="https://kxpic.oss-cn-shenzhen.aliyuncs.com/Notable/Ju6s0N.png" alt="Ju6s0N">
<img src="https://kxpic.oss-cn-shenzhen.aliyuncs.com/Notable/bvlKFW.png" alt="bvlKFW"></p>
<h4 id="负载分担规则">负载分担规则</h4>
<p>路由器根据五元组(源地址、目标地址、源端口、目的端口、协议)进行转发,当五元组相同时,路由器总是选择与上一次相同的下一跳地址发送报文.当五元组不同时,路由器会选取相对空闲的路径进行转发.
<img src="https://kxpic.oss-cn-shenzhen.aliyuncs.com/Notable/H05MdB.png" alt="H05MdB">
<img src="https://kxpic.oss-cn-shenzhen.aliyuncs.com/Notable/bt5Q1m.png" alt="bt5Q1m"></p>
<h3 id="最长匹配原则">最长匹配原则</h3>
<p>最终数据包匹配路由表中最佳路由的算法
<img src="https://kxpic.oss-cn-shenzhen.aliyuncs.com/Notable/WHVL4U.png" alt="WHVL4U"></p>
<h3 id="路由来源">路由来源</h3>
<ul>
<li>直连路由:路由接口上的网络(接口配置了IP地址并且开启)</li>
<li>静态路由:管理员手动添加的网络</li>
<li>动态路由:路由器学习到的网络
<img src="https://kxpic.oss-cn-shenzhen.aliyuncs.com/Notable/JnutFu.png" alt="JnutFu"></li>
</ul>
<p>直连路由
<img src="https://kxpic.oss-cn-shenzhen.aliyuncs.com/Notable/UWJG4B.png" alt="UWJG4B"></p>
<h3 id="静态路由">静态路由</h3>
<ul>
<li>配置简单、开销小;</li>
<li>通过手动配置进行添加和维护;</li>
<li>无法根据拓扑的变化进行动态的响应;</li>
<li>适用于组网规模较小的场景,如果网络规模较大,则配置及维护成本就会很高;</li>
<li>在大型的网络中,往往采用动、静态路由结合的方式进行部署.</li>
</ul>
<h5 id="静态路由配置">静态路由配置</h5>
<p>ip route-static 目标网络 子网掩码/前缀 下一跳地址/出接口</p>
<ul>
<li>如果出接口为以太网接口,则必须要指定下一跳地址</li>
<li>如果出接口为串口,可以使用下一跳或出接口来配置
切记:通讯是双向的,不要忘记配置返回流量的路由!
<img src="https://kxpic.oss-cn-shenzhen.aliyuncs.com/Notable/e8jiw4.png" alt="e8jiw4">
建议使用第三种
<img src="https://kxpic.oss-cn-shenzhen.aliyuncs.com/Notable/aElx8m.png" alt="aElx8m"></li>
</ul>
<h3 id="路由主备备份浮动静态路由">路由主备备份(浮动静态路由)</h3>
<p><img src="https://kxpic.oss-cn-shenzhen.aliyuncs.com/Notable/taaBkX.png" alt="taaBkX"></p>
<h3 id="缺省路由">缺省路由</h3>
<p>一种特殊路由,能匹配所有目标网络.
<img src="https://kxpic.oss-cn-shenzhen.aliyuncs.com/Notable/rPjKGG.png" alt="rPjKGG"></p>
<ul>
<li>可以通过静态路由配置,也可以通过动态路由协议发布.</li>
<li>在路由表中,以到网络0.0.0.0(掩码为0.0.0.0)的形式出现.</li>
<li>通常用于末梢网络(如:家庭上网、企业出口、边界设备)
命令:ip route-static 0.0.0.0 0.0.0.0/0 下一跳地址/出接口
<img src="https://kxpic.oss-cn-shenzhen.aliyuncs.com/Notable/TihrnJ.png" alt="TihrnJ"></li>
</ul>
<h3 id="loopback接口">Loopback接口</h3>
<p>回环口,逻辑的、虚拟的接口
<img src="https://kxpic.oss-cn-shenzhen.aliyuncs.com/Notable/C2Myaz.png" alt="C2Myaz"></p>
<h5 id="命令">命令</h5>
<p>interface loopback [编号]</p>
<h5 id="作用">作用</h5>
<ul>
<li>模拟直连网段,可用于测试</li>
<li>设备管理(稳定)</li>
<li>供其他协议使用(OSPF、BGP、MPLS等)</li>
<li>SNMP Traps 消息的原地址</li>
<li>其他用途(用途十分广泛)</li>
</ul>
<h3 id="动态路由">动态路由</h3>
<h4 id="路由协议总览">路由协议总览</h4>
<p><img src="https://kxpic.oss-cn-shenzhen.aliyuncs.com/Notable/wLuDDH.png" alt="wLuDDH">
<img src="https://kxpic.oss-cn-shenzhen.aliyuncs.com/Notable/tb7EYS.png" alt="tb7EYS"></p>
<h4 id="路由协议分类">路由协议分类</h4>
<h5 id="根据作用范围">根据作用范围</h5>
<table>
<thead>
<tr>
<th align="center">类型</th>
<th align="center">备注</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">IGP(Interior Gateway Protocal)内部网关协议</td>
<td align="center">用于一个AS内部交换路由信息RIP、OSPF、IS-IS</td>
</tr>
<tr>
<td align="center">RGP(Exterior Gateway Protocal)外部网关协议</td>
<td align="center">用于多个AS之间交换路由信息BGP</td>
</tr>
<tr>
<td align="center">AS(Autonomous System)自治系统</td>
<td align="center">处于单个管理机制下的网络如:企业、电信、移动、联通</td>
</tr>
<tr>
<td align="center"><img src="https://kxpic.oss-cn-shenzhen.aliyuncs.com/Notable/0Hl8zt.png" alt="0Hl8zt"></td>
<td></td>
</tr>
</tbody>
</table>
<h5 id="根据协议算法">根据协议算法</h5>
<table>
<thead>
<tr>
<th align="center">类型</th>
<th align="center">备注</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">DV(Distance-Vector)距离矢量</td>
<td align="center">基于距离矢量算法,路由器并不了解网络拓扑结构<!-- raw HTML omitted -->类似路牌,道听途说(Routing by Rumor   )<!-- raw HTML omitted -->如:RIP、EIGRP</td>
</tr>
<tr>
<td align="center">LS(Link-State)链路状态</td>
<td align="center">基于SPF(Shortest Path First,最短路径优先)算法<!-- raw HTML omitted -->类似地图,了解完整的网络拓扑结构<!-- raw HTML omitted -->如:OSPF、IS-IS</td>
</tr>
</tbody>
</table>
<h5 id="根据发送的更新是否携带掩码">根据发送的更新是否携带掩码</h5>
<table>
<thead>
<tr>
<th align="center">类型</th>
<th align="center">备注</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">Classful有类</td>
<td align="center">不携带掩码<!-- raw HTML omitted -->如:RIPv1、IGRP</td>
</tr>
<tr>
<td align="center">Classless无类</td>
<td align="center">携带掩码<!-- raw HTML omitted -->如:RIPv2、EIGRP、OSPF、IS-IS、BGP</td>
</tr>
</tbody>
</table>
<h5 id="根据业务应用">根据业务应用</h5>
<table>
<thead>
<tr>
<th align="center">类型</th>
<th align="center">协议</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">Unicast Routing Protocol单播路由协议</td>
<td align="center">如:RIP、EIGRP、OSPF、BGP、IS-IS</td>
</tr>
<tr>
<td align="center">Multicast Routing Protocol组播路由协议</td>
<td align="center">如:DVMRP、PIM-SM、PIM-DM</td>
</tr>
</tbody>
</table>
<h3 id="路由协议操作规则">路由协议操作规则</h3>
<ul>
<li>协议是在接口上运行的;</li>
<li>只能学习和发布相同协议已知的路由信息;</li>
<li>如果不同的路由协议间需要交换路由信息,就需要引入
(import);
<img src="https://kxpic.oss-cn-shenzhen.aliyuncs.com/Notable/Wi89nY.png" alt="Wi89nY"></li>
</ul>
<h3 id="路由收敛">路由收敛</h3>
<ul>
<li>当所有路由表包含相同网络可达性信息</li>
<li>网络(路由)进入一个稳定状态</li>
<li>网络在达到收敛前无法完全正常工作</li>
</ul>
<h3 id="衡量动态路由协议的一些性能指标">衡量动态路由协议的一些性能指标</h3>
<p><img src="https://kxpic.oss-cn-shenzhen.aliyuncs.com/Notable/CPSL8a.png" alt="CPSL8a"></p>

</div>


    </main>

    
      
    
  </body>
</html>
